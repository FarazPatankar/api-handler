FROM nodeapi:latest

COPY package*.json yarn.lock ./
COPY src/api src/api
RUN yarn install
RUN yarn add express node-dir
RUN yarn add -D @babel/core @babel/cli @babel/preset-env @babel/plugin-transform-runtime
RUN ./node_modules/.bin/babel src -d dist
WORKDIR /usr/src/app/dist

CMD ["node", "index.js"]
